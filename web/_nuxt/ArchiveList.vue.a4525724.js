import{_ as R}from"./SortByDropdown.vue.f6dc84f1.js";import{_ as S}from"./TitleList.vue.0fbe722d.js";import{d as B,S as E,C as L,r as f,U as P,l as C,ac as q,o as k,e as x,h as y,w as H,g as i,L as M,I as N}from"./entry.63203ae2.js";import{u as O}from"./useArchiveIcon.18656aa1.js";function w(l){let o,s=l[0],c=1;for(;c<l.length;){const t=l[c],r=l[c+1];if(c+=2,(t==="optionalAccess"||t==="optionalCall")&&s==null)return;t==="access"||t==="optionalAccess"?(o=s,s=r(s)):(t==="call"||t==="optionalCall")&&(s=r((...p)=>s.call(o,...p)),o=void 0)}return s}const T={class:"flex min-h-full w-full flex-col"},D=B({__name:"ArchiveList",props:{slug:{}},setup(l){const o=l,s=E(),c=L(),t=f(!0),r=P(),p=C(()=>w([[...s.categories,...s.genres],"access",e=>e.find,"call",e=>e(a=>a.slug===o.slug),"optionalAccess",e=>e.name])),d=f(),g=f(),m=C(()=>r.query.sortBy||"relevant"),h=r.query.stream==="true",v=f({}),_=f(m.value);async function A(e,a){a!==_.value&&(v.value={},_.value=a),t.value=!0;const n=await M("ARCHIVE::"+[o.slug].join(",")+e+a+h,()=>N.API.actions.archive([o.slug],h,e,a));d.value=n,t.value=!1,n&&(w([d,"access",u=>u.value,"optionalAccess",u=>u.error])&&c(d.value.msg,"ERROR"),v.value[e]=n.result.posts,g.value={pages:n.result.pages,page:n.result.page,total:n.result.total})}return q(()=>{const e=Number(r.query.page||"1");A(e,m.value)}),(e,a)=>{const n=R,u=S;return k(),x("div",T,[y(u,{"secondary-title-type":"",transparent:"",class:"min-h-full",title:i(p)||"",icon:("useArchiveIcon"in e?e.useArchiveIcon:i(O))(e.slug),"is-loading":i(t),data:i(v),"result-info":i(g),onPageChanged:a[0]||(a[0]=I=>A(I,i(m)))},{header:H(()=>[y(n)]),_:1},8,["title","icon","is-loading","data","result-info"])])}}});export{D as _};
